---
title: "Dubbo Framework Description"
date: 2018-03-02T15:07:46+08:00
tags: ["dubbo"]
draft: false
---

------

# Dubbo Framework Description

## 架构

### 说明

* 让我们从一张图说起

  ![](http://xuxifu-blog-img.oss-cn-beijing-internal.aliyuncs.com/post/dubbo/image/20180302_Architecture.png)

| 节点        | 角色说明                               |
| ----------- | -------------------------------------- |
| `Provider`  | 暴露服务的服务提供方                   |
| `Consumer`  | 调用远程服务的服务消费方               |
| `Registry`  | 服务注册与发现的注册中心               |
| `Monitor`   | 统计服务的调用次数和调用时间的监控中心 |
| `Container` | 服务运行容器                           |

* 调用关系
  0. 容器负责加载和运行服务提供方
  1. 服务提供方向注册中心注册自己的服务
  2. 服务消费方向注册中心订阅自己的服务
  3. 注册中心返回服务提供方的地址，如有变动通过长连接推送变动后的地址给服务消费方
  4. 服务消费方通过负载算法选取一台服务提供方调用，如果调用失败，再选取一次
  5. 消费者和服务者在内存中记录调用次数和时长，定时每分钟发送一次统计结果到监控中心


### 此架构的特性

* 连通性

  * **注册中心压力小** 只负责地址的注册和查找，消费者和服务者只有在启动时才和注册中心交付，注册中心不转发请求

  * **监控中心记录及报表展示** 监控中心统计各服务的调用次数和时间，记录在内存中每分钟发往监控中心，报表展示

  * **提供者提供服务并汇报调用时间** 提供者向注册中心注册服务，并向监控中心汇报调用时间，但这个时间不包含网路开销

  * **消费者使用服务并会不调用时间** 消费者向注册中心获取提供者地址，并通过负载算法调用提供者，并向监控中心汇报调用时间，此时间包括网路开销

  * **注册中心为长连接** 注册中心和消费者，提供者之间为长连接，监控中心除外

  * **注册中心感知提供者** 注册中心感知提供者，如果提供者宕机，注册中心推送事件到消费者

  * **注册中心和监控中心宕机不影响服务使用** 消费者会缓存提供者列表

  * **注册中心和监控中心可选** 消费者可以直连提供者

    ​

* 健壮性

  * **监控中心宕机** 丢失部分采集数据

  * **数据库宕机** 缓存提供服务列表，不能添加新服务

  * **注册中心集群部分宕机 ** 一台宕机会切换到另外一台使用

  * **注册中心集群全部宕机**  服务提供者和服务消费者可以通过本地缓存通讯

  * **服务提供者部分宕机** 不影响服务使用

  * **服务提供者全部宕机** 消费者无法使用服务，并无限重连等待服务

    ​

* 伸缩性

  * **注册中心对等集群**  可动态增加部署实例，客户端将自动发现新的注册中心

  * **服务提供者增加实例** 注册中心将推送新的提供者给消费者

    ​

* 升级性

  * 这是Dubbo未来的图

    ![](http://xuxifu-blog-img.oss-cn-beijing-internal.aliyuncs.com/post/dubbo/image/20180302_dubbo_future.png)

  ##### 节点角色说明

  | 节点         | 角色说明                               |
  | ------------ | -------------------------------------- |
  | `Deployer`   | 自动部署服务的本地代理                 |
  | `Repository` | 仓库用于存储服务应用发布包             |
  | `Scheduler`  | 调度中心基于访问压力自动增减服务提供者 |
  | `Admin`      | 统一管理控制台                         |
  | `Registry`   | 服务注册与发现的注册中心               |
  | `Monitor`    | 统计服务的调用次数和调用时间的监控中心 |

